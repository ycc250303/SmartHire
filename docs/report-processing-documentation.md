# SmartHire 举报处理系统文档

## 概述

SmartHire举报处理系统是一个完整的用户举报和后台处理机制，支持对用户和职位进行举报，管理员可以处理举报并发送通知给相关用户。

## 数据库表结构

### 1. reports 表 - 举报记录主表

| 字段名 | 类型 | 说明 | 备注 |
|--------|------|------|------|
| id | BIGINT | 举报ID | 主键，自增 |
| reporter_id | BIGINT | 举报人ID | 关联user表的ID |
| target_type | TINYINT | 举报对象类型 | 1-用户, 2-职位 |
| target_id | BIGINT | 举报对象ID | 用户ID或职位ID |
| report_type | TINYINT | 举报类型 | 1-垃圾信息, 2-不当内容, 3-虚假职位, 4-欺诈行为, 5-骚扰行为, 6-其他 |
| reason | TEXT | 举报原因/详细描述 | 用户填写的举报内容 |
| status | TINYINT | 处理状态 | 0-待处理, 1-已处理 |
| handler_id | BIGINT | 处理人ID | 管理员ID |
| handle_result | TINYINT | 处理结果 | 0-无需处理, 1-警告, 2-封禁, 3-下线 |
| handle_reason | TEXT | 处理原因 | 管理员填写的处理原因 |
| handle_time | DATETIME | 处理时间 | 处理完成的时间 |
| evidence_image | VARCHAR(255) | 举报证据图片URL | 支持OSS等云存储URL |
| created_at | DATETIME | 创建时间 | 举报提交时间 |
| updated_at | DATETIME | 更新时间 | 最后修改时间 |

#### 枚举值说明

**target_type (举报对象类型)**
- `1`: 用户 (求职者或HR账号)
- `2`: 职位 (HR发布的招聘信息)

**report_type (举报类型)**
- `1`: 垃圾信息 - 无意义或重复内容
- `2`: 不当内容 - 违反平台规范的内容
- `3`: 虚假职位 - 不真实的招聘信息
- `4`: 欺诈行为 - 涉及诈骗的恶意行为
- `5`: 骚扰行为 - 对其他用户的骚扰
- `6`: 其他 - 其他违规行为

**status (处理状态)**
- `0`: 待处理 - 管理员尚未处理的举报
- `1`: 已处理 - 管理员已处理完成的举报

**handle_result (处理结果)**
- `0`: 无需处理 - 经审核认为举报不成立
- `1`: 警告 - 对被举报方进行警告处理
- `2`: 封禁 - 封禁用户账号（针对用户举报）
- `3`: 下线 - 下线职位（针对职位举报）

### 2. notifications 表 - 用户通知表

| 字段名 | 类型 | 说明 | 备注 |
|--------|------|------|------|
| id | BIGINT | 通知ID | 主键，自增 |
| user_id | BIGINT | 接收用户ID | 关联user表的ID |
| type | TINYINT | 通知类型 | 1-系统消息, 2-举报处理, 3-封禁通知, 4-职位下线 |
| title | VARCHAR(255) | 通知标题 | 通知的标题文字 |
| content | TEXT | 通知内容 | 详细的通知内容 |
| related_id | BIGINT | 关联业务ID | 举报ID、职位ID等 |
| related_type | VARCHAR(50) | 关联业务类型 | report, job, user |
| is_read | TINYINT | 是否已读 | 0-未读, 1-已读 |
| priority | TINYINT | 优先级 | 0-低, 1-中, 2-高 |
| created_at | DATETIME | 创建时间 | 通知发送时间 |
| read_at | DATETIME | 阅读时间 | 用户阅读通知的时间 |

#### 通知类型说明

**type (通知类型)**
- `1`: 系统消息 - 平台公告、系统更新等
- `2`: 举报处理 - 举报处理结果通知
- `3`: 封禁通知 - 用户账号封禁通知
- `4`: 职位下线 - 职位被下线通知

**related_type (关联业务类型)**
- `report`: 与举报相关的通知
- `job`: 与职位相关的通知
- `user`: 与用户相关的通知

## 管理端功能

### 1. 举报列表查看
- 分页查询所有举报记录
- 支持按举报类型、状态、对象类型筛选
- 支持关键词搜索
- 显示举报状态统计

### 2. 举报详情查看
- 显示举报人信息和被举报对象信息
- 显示举报原因和证据图片
- 支持查看被举报用户/职位的详细信息

### 3. 举报处理功能
- **无需处理**: 认为举报不成立，不做额外操作
- **警告**: 发送警告通知给被举报方
- **封禁用户**: 封禁用户账号（支持永久封禁和临时封禁）
- **下线职位**: 下线被举报的职位

### 4. 通知机制
- 自动发送通知给举报方，告知处理结果
- 自动发送通知给被举报方，告知处理决定
- 支持自定义通知内容
- 所有通知记录保存在notifications表中

## 用户端需要实现的功能

### 1. 发起举报功能

**前端页面需求:**
- 举报表单页面，包含以下字段：
  - 举报对象选择（用户/职位）
  - 举报类型选择（下拉框）
  - 举报原因描述（文本域，必填）
  - 证据图片上传（支持图片文件，上传后获取URL）

**API接口需求:**
```
POST /api/reports
{
  "targetType": 1,           // 举报对象类型：1-用户, 2-职位
  "targetId": 123,           // 举报对象ID
  "reportType": 2,           // 举报类型
  "reason": "举报原因描述",   // 举报原因
  "evidenceImage": "https://xxx.jpg"  // 证据图片URL（可选）
}
```

**功能实现要点:**
- 用户必须登录才能发起举报
- 验证举报对象是否存在
- 图片上传需要集成文件上传服务，返回URL
- 举报成功后显示成功提示

### 2. 接收通知功能

**通知中心页面:**
- 显示用户收到的所有通知
- 支持按通知类型筛选
- 支持标记已读/未读
- 未读通知数量提醒

**API接口需求:**
```
GET /api/notifications?page=1&size=10&type=2&isRead=0
```

**通知类型处理:**
- **举报处理通知**: 显示举报结果和处理原因
- **封禁通知**: 显示封禁原因和封禁时长
- **职位下线通知**: 显示下线原因和修改建议
- **系统消息**: 显示平台公告和重要信息

**功能实现要点:**
- 实时通知推送（可选）
- 通知列表分页加载
- 点击通知标记为已读
- 支持批量标记已读/删除


## 业务流程

### 举报处理流程

1. **用户发起举报**
   - 选择举报对象和类型
   - 填写举报原因
   - 上传证据图片（可选）
   - 提交举报记录

2. **管理员处理举报**
   - 查看举报列表和详情
   - 调查被举报对象
   - 选择处理结果
   - 填写处理原因
   - 执行处理操作

3. **自动通知发送**
   - 给举报方发送处理结果通知
   - 给被举报方发送处理决定通知
   - 记录通知到数据库

4. **用户查看通知**
   - 在通知中心查看
   - 点击查看详情
   - 根据通知内容进行相应操作

### 数据流转

```
用户举报 → reports表 → 管理员处理 → 更新reports表 → 生成通知 → notifications表 → 用户查看
```

## 扩展功能建议

### 1. 举报申诉
- 被举报用户可以对处理结果进行申诉
- 管理员可以重新审核申诉

### 2. 举报统计
- 举报类型统计报表
- 用户举报行为分析
- 处理效率统计

### 3. 自动化处理
- 基于规则的自动处理
- 重复举报合并
- 高危举报自动升级

### 4. 通知模板
- 可配置的通知模板
- 多语言支持
- 个性化通知内容